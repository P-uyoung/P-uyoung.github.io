---
layout: single  # single, 댓글기능을 달기 위해...
title:  "[rPPG Project] Remote Heart Rate Monitoring (KCI)"
categories: Trouble_Shooting
# tag: [rPPG Project]
toc: true
toc_sticky: false
author_profile: false
search: true
use_math: true
---
<br/>

<h1 align="center">Remote Heart Rate Monitoring</h1>
---


**서울대학교 데이터사이언스대학원 2022 AI 경진대회**

**원격 심박수 측정 프로젝트 (2022.08.15 ~ 2022.09.18)**

## 1. 기술 원리

### "신체의 <u>빛 흡수량</u>과 <u>심장박동수</u>의 상관관계"

 스마트폰으로 촬영한 영상 데이터의 RGB 신호를 통해 심박수를 측정하는 프로젝트입니다.   
 <u>심장박동수</u>는 우리의 <u>혈관에 흐르는 피의 양(혈류량)</u>과 밀접한 관련이 있다. 즉, 혈류량의 변화를 통해 심장박동수를 알 수 있습니다.    
 이때, 혈류량의 변화는 신체에 빛을 비추었을 때, 그 <u>빛의 흡수량</u>을 통해 알 수 있습니다. 이는 핸드폰 플래쉬를 손끝에 대보았을 때 빨갛게 보이는데, 이 <u>색상의 변화는 심장박동수에 따라 변합</u>니다.   
 **<span style="color:dodgerblue">따라서, 영상 속 사람의 얼굴의 RGB 변화를 통해 심박수 변화를 측정하는 원리입니다.</span>**

<!-- ### 2. 프로젝트 알고리즘

#### 2.1. Face Detection : residual neural network(ResNet)으로 구현 

Face Detection에는 ResNet 알고리즘을 사용하였습니다. 여기서, ResNet 알고리즘에 대해 살펴보겠습니다.   

neural network(NN)에서 이미지 처리에는 기본적으로 convolutional neural network(CNN)이 사용되고, 자연어 처리에는 recurrent neural network(RNN)이 사용됩니다.   

하지만, CNN과 RNN은 신경망의 레이어가 깊어지면 vanishing gradient problem이 발생하여 오류가 증가하는 문제가 있습니다. 이러한 이슈를 해결하기 위한 것이, ResNet 알고리즘입니다.  

https://losskatsu.github.io/machine-learning/resnet/#1-%EA%B8%B0%EC%A1%B4-%EC%8B%A0%EA%B2%BD%EB%A7%9D%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90

https://losskatsu.github.io/machine-learning/resnet/#1-%EA%B8%B0%EC%A1%B4-%EC%8B%A0%EA%B2%BD%EB%A7%9D%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90

https://wandukong.tistory.com/18

#### 2.2. Heart Rate Estimation : temporal shift-convolutional attention network(TS-CAN)로 구현 -->


## 3. 트러블 슈팅

### 문제상황 : **batch inputs 지원 문제로 인한, 런타임에러**


텐서플로우(TF)로 pre-trained 모델을 텐서플로우 라이트(TFLite)로 변환하는 과정에서 RuntimeErrorr가 발생하였습니다. 이는, TFLite는 TF와 달리, batch inputs을 지원하지 않기 때문이였습니다.  

<img src="/assets/images/2023-02-06-rPPG/Trouble_RuntimeError.png" />

### 해결 : 차원 추가
해당 모델의 input feature 차원은 가로\*세로\*3(RGB 채널) 인데, 각 batch를 하나의 차원으로 생각하여 <u>4차원으로 배열</u>을 추가하여 모델링하였습니다. 


 

### 4. 컨퍼런스 논문

<img src="/assets/images/2023-02-06-rPPG/(1-2) ebook.jpg" style="zoom:20%;"/> |<img src="/assets/images/2023-02-06-rPPG/(2-2) ebook.jpg" style="zoom:20%;"/>

### 5. 링크

> [Github 코드 보러가기](https://github.com/P-uyoung/Ambient_RPPG/blob/main/README.md)  

> [데모영상 보러가기](https://www.youtube.com/watch?v=GAX9GWvPWNs)   



<br/>


